---
SWC-ID:100
Title: Reentrancy
Status: Draft
Severity: High
CWE: 703 -> 691 -> 667
Tags: reentrancy, external-call, state-update, eth, smart-contract
---

# SWC-100 - Reentrancy
> Reseearch notes & full PoC suite
> Living document - last update: 2025-09-24

---

# 1. Ringkasan singkat
Reentrancy terjadi ketika kontrak memanggil external address **sebelum** memperbarui state internal-nya.
Kontrak penerima (attacker) dapat memanggil balik fungsi korban dalam satu transaksi sehingga logic yang sama dieksekusi berulang kali - biasanya mengakibatkan **kehilangan dana** atau **state korup**.

Also knowm as: **recursive call attack**, **DAO attack**.

---

## 2. Deskripsi teknis
### 2.1 Pola yang dilanggar
*Check-Effects-Interactions*:
1. Check    -> `require(balance[msg.sender] > 0)`
2. Effect   -> `balance[msg.sendder] = 0` (**terlewat**)
3. Interact -> `(bool ok, ) = msg.sender.call{ value: amount }("")`

### 2.2 Contoh kode rentan (solidity >=0.8)
```Solidity
//SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.0;
contract Vulnerable_Contract {
    mapping(address => uint) public balance;

    function deposit() external payable {
        balance[msg.sender] += msg.value;
    }

    function withdraw() external {
        uint amount = balance[msg.sender];
        require(amount > 0);

        // FLAW: External call sebelum update State
        (bool ok, ) = msg.sender.call{ value: amount }("");
        require(ok, "Transfer Failed!");

        balance[msg.sender] = 0; // Update State terlambat dan bisa di-eksploitasi 
    }
}